---
Title: "AAI1001 Data Engineering and Visualization Group 3 Project"
Author: "Group 3"
embed-resources: true
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    number-depth: 3
editor: 
  markdown: 
    wrap: 72
---

<font size="6"> **Team Project Proposal** </font>

**Authors:** - **Muhammad Azreen Bin Muhammad**

For this document, the following packages are required:

```{r}
#| label: setup 
#| include: true
library(DBI)
library(knitr)
library(readxl)
library(tidyverse)

```

# Original Data Visualization in News Media

The geographical distribution of Singapore's population is a focal point
of urban studies and public policy discussions. The introduction of a
new visualization of demographic trends across various planning areas
provides a novel perspective on this discourse. Our project aims to
dissect the relationship between demographic characteristics and urban
planning policies. The observed patterns, while not entirely random, may
be consistent with hypotheses regarding the impact of strategic urban
development on population distribution.

Our visualization, inspired by the seminal work of the Singapore
Department of Statistics (2023), encapsulates data from the year 2023, a
period marked by significant urban and demographic changes. While our
initial rendition has been commended for its clarity in showcasing
trends, it is the addition of interactive elements (as showcased in
Figure 1) that promises a deeper engagement with the data. Nonetheless,
we acknowledge room for improvement. Incorporating interactive toggles,
expanded temporal ranges, and detailed geospatial mappings will refine
our approach, providing a more comprehensive exploration of how urban
planning influences demographic distribution and housing patterns in
Singapore.

# Critical Assessment of the Original The selected visualization from
The Singapore Department of Statistics presents several variables:
population distribution (quantitative), age profile (quantitative),
housing types (categorical), and planning areas (categorical).
Additionally, the visualization includes interactive elements that allow
users to delve into specific data points, enhancing the engagement and
depth of analysis.

The plot utilizes a combination of charts and maps to effectively
communicate the demographic and housing trends across different planning
areas. The clarity and detail of the data presentation have been
commended, as it allows users to easily identify and understand the
trends. The use of interactivity, such as hovering over data points for
more information, adds a layer of depth that static visualizations lack.

However, there are some shortcomings the team has identified:

1.  Complexity: While the visualization is thorough, its complexity may
    be overwhelming for some users, especially those unfamiliar with
    demographic data or geographical information systems (GIS).

2.  Accessibility: The reliance on color and detailed graphics may pose
    accessibility challenges for users with visual impairments or those
    who are not tech-savvy

3.  Data Density: The high density of information in a single
    visualization can lead to cognitive overload, where important
    details might be overlooked due to the sheer volume of data
    presented.

4.  Limited Temporal Range: The visualization only covers data for the
    year 2023, which constrains the analysis to a narrow timeframe and
    does not allow for the examination of trends over time.

5.  Lack of Customization: Users cannot customize the time range or select specific years of
    interest, limiting the depth of their analysis.

6.  Static Elements: While some elements are interactive, the visualization could benefit
    from more dynamic features such as changing bubble sizes or color
    gradients to depict demographic shifts over time.

# Proposed Improvements

We propose to address the shortcomings of the original visualization as
follows:

1.  Better contrast: Utilize high-contrast colors to improve accessibility for users with visual impairments, ensuring clarity and ease of interpretation for all users.

2.  Reduced Data Density: Simplify the presentation by reducing the number of data points displayed simultaneously, thus preventing overcrowding and making the visualization more comprehensible.

3.  Interactive Elements: Hovering over a country will display a tooltip with detailed information on the population size of a certain region of singapore as well the age profile.

4.  Expanded Temporal Ranges: Introduce options for users to select specific time periods for analysis, facilitating a deeper exploration of trends over time.

# Data Cleaning

The Singapore Department of Statistics based its visualization on data collected by the Singapore Government from the year 2023 available in CSV format. The data includes the following columns: Planning Area, Population, Age Profile, and Gender. For our improved visualization we will be using dataset dating as far back as 2000 to 2023. The department of statistics categorize the data into a range of 10 years (e.g 2000-2010,2011-2020) and for data set that have not met the 10 year range are given in seperate files instead. As such we will first have to combined the data into a single file and then clean the data to ensure that it is in a Dataframe.

Insert code to read the data from the CSV files and combine them into a single dataframe.

```{r}
setwd("C:/Users/benfu/data_vis/DEnVGrp3Proj/data")

# List all CSV files in the directory
file_list <- list.files(pattern = "*.csv")

# Read and combine all CSV files
csv_list <- lapply(file_list, read.csv)
combined_data <- do.call(rbind, csv_list)

# Save the combined data frame to a new CSV file (optional)
write.csv(combined_data, "combined_data.csv", row.names = FALSE)


```

Once the data has been combined, we will perform a summary of the data using the glimpse() and summary() function to understand the structure of the data and identify any missing values or inconsistencies.

```{r}
# Reading csv file
df <- read.csv("data/combined_data.csv")
# Deleting "SZ" and "Sex" columns
df <- df %>% select(-"SZ", -"Sex")
# Function to create age groups from 1,2,3,4... to 1-9, 10,19...
create_age_group <- function(age) {
  if (age == "90_and_over" || age == "90_and_Over") {
    return("90 and Over")
  } else {
    age_num <- as.numeric(age)
    group_start <- (age_num %/% 10) * 10
    group_end <- group_start + 9
    return(paste0(group_start, " to ", group_end))
  }
}
# Mutating the age column into a new AgeGroup column
df <- df %>% mutate(AgeGroup = sapply(Age, create_age_group))

head(df)

```
```{r}
# Function to clean the 'Pop' column by removing non-numeric characters
clean_pop <- function(pop) {
  # Remove any non-digit characters
  clean_pop <- gsub("[^0-9]", "", pop)
  return(clean_pop)
}
# Apply the cleaning function to the 'Pop' column
df$Pop <- sapply(df$Pop, clean_pop)
# Convert Pop to numeric for aggregation
df$Pop <- as.numeric(df$Pop)
# Move columns to a new data frame to consolidate total population, Age Group and Time
aggregated_df <- df %>%
  group_by(PA, AgeGroup, Time) %>%
  summarise(TotalPop = sum(Pop, na.rm = TRUE))

head(aggregated_df)
```
```{r}
# For testing
write_csv(aggregated_df, "test.csv")
```

The relevant columns that we will be using are as follows:

-
-
-

As we are only interested in providing state level data that is easy to read for ordinary users, we will be filtering out the data that is not relevant to our visualization. For instance


# Conclusion

The data is now ready for visualization. The next step will be to create a plot that can effectively communicate the relationship between the population density in each region of singapore over time, and additionally allow curious readers to explore the data even further using interactivity. We will use ggplot2 package to create the plot, and plotly to add interactivity. 

